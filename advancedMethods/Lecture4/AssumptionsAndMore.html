<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/grid-no-htext-1.0.0/grid_no_htext.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.543">

  <meta name="author" content="Esteban Montenegro-Montenegro, PhD">
  <title>{HASO} - Correlation and Regression Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        background-color: #2a211c;
        color: #bdae9d;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
    div.sourceCode
      { color: #bdae9d; background-color: #2a211c; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ffff00; } /* Alert */
    code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { } /* Attribute */
    code span.bn { color: #44aa43; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #049b0a; } /* Char */
    code span.cn { } /* Constant */
    code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
    code span.do { color: #0066ff; font-style: italic; } /* Documentation */
    code span.dt { text-decoration: underline; } /* DataType */
    code span.dv { color: #44aa43; } /* DecVal */
    code span.er { color: #ffff00; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #44aa43; } /* Float */
    code span.fu { color: #ff9358; font-weight: bold; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
    code span.op { } /* Operator */
    code span.pp { font-weight: bold; } /* Preprocessor */
    code span.sc { color: #049b0a; } /* SpecialChar */
    code span.ss { color: #049b0a; } /* SpecialString */
    code span.st { color: #049b0a; } /* String */
    code span.va { } /* Variable */
    code span.vs { color: #049b0a; } /* VerbatimString */
    code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
  <script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
  <link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="stan_state_screen_5.png" data-background-opacity="0.3" class="quarto-title-block center">
  <h1 class="title">Correlation and Regression Models</h1>
  <p class="subtitle">Part 3: ANOVA and The General Linear Model</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Esteban Montenegro-Montenegro, PhD 
</div>
        <p class="quarto-title-affiliation">
            Psychology and Child Development
          </p>
    </div>
</div>

</section>
<section id="why-are-we-studying-the-regression-model-and-other-demons" class="slide level2 smaller scrollable">
<h2>Why are we studying the regression model and other demons?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(ISLR)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(DT)</span>
<span id="cb1-3"><a></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="fu">library</span>(broom)</span>
<span id="cb8-2"><a></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: viridisLite</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Regression is only one member of the family of <strong><em>General Linear Model (GLM)</em></strong>.</p></li>
<li><p>The GLM covers models such as Analysis of Variance (ANOVA), Multivariate Analysis of Variance (MANOVA), Classical Regression Model (linear regression) and <span class="math inline">\(t\)</span>-test.</p></li>
<li><p>My aim was to introduce these topics as a generalization of GLM, or better said, as a family.</p></li>
<li><p>There is a large theory related to these GLM models, but we don’t have time to discuss every detail. More advanced classes are necessary to explain particular details.</p></li>
</ul>
<div class="cell" data-reveal="true" data-fig-width="6.5" data-fig-height="6.5" data-fig-responsive="false" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">
  graph TD
    A[GLM] --&gt; B(ANOVA)
    A[GLM] --&gt; C(MANOVA)
    A[GLM] --&gt; D(t-test)
    A[GLM] --&gt; E(Linear Regression)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="lets-make-up-time-for-anova" class="slide level2 smaller scrollable">
<h2>Let’s make up time for ANOVA</h2>
<ul>
<li><p>Analysis of Variance a.k.a ANOVA is a model that helps to analyze mean differences in multiple groups. It is actually very similar to the Classical Regression Model, that’s why I included ANOVA in the Classical Regression Model lecture.</p></li>
<li><p>The ANOVA model tests the <strong><em>null hypothesis</em></strong> that all group means are equal. It could be represented like this:</p></li>
</ul>
<span class="math display">\[\begin{equation}
H_{0}: \mu_{1} = \mu_{2} = \mu_{3}
\end{equation}\]</span>
<ul>
<li><p>This would be what we call an <em>omnibus test</em>, which means we are testing the overall effect of our independent variable on the dependent variable.</p></li>
<li><p>As always, let’s understand this with an example:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>Wage <span class="sc">|&gt;</span> <span class="fu">select</span>(wage, maritl) <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a></a>            <span class="fu">group_by</span>(maritl) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a></a>            <span class="fu">summarise</span>(<span class="at">M =</span> <span class="fu">round</span>(<span class="fu">mean</span>(wage),<span class="dv">2</span>),</span>
<span id="cb11-4"><a></a>                      <span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(wage),<span class="dv">2</span>),</span>
<span id="cb11-5"><a></a>                      <span class="at">variance =</span> <span class="fu">round</span>(<span class="fu">var</span>(wage),<span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Wage's mean, sd, and variance by Marital Status"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a></a><span class="fu">kable_classic_2</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> T,<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic-2 lightable-hover" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Wage's mean, sd, and variance by Marital Status</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">maritl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">M</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1. Never Married</td>
<td style="text-align: right;">92.73</td>
<td style="text-align: right;">32.92</td>
<td style="text-align: right;">1083.73</td>
</tr>
<tr class="even">
<td style="text-align: left;">2. Married</td>
<td style="text-align: right;">118.86</td>
<td style="text-align: right;">43.12</td>
<td style="text-align: right;">1859.38</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3. Widowed</td>
<td style="text-align: right;">99.54</td>
<td style="text-align: right;">23.74</td>
<td style="text-align: right;">563.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">4. Divorced</td>
<td style="text-align: right;">103.16</td>
<td style="text-align: right;">33.80</td>
<td style="text-align: right;">1142.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5. Separated</td>
<td style="text-align: right;">101.22</td>
<td style="text-align: right;">33.66</td>
<td style="text-align: right;">1133.22</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li>In the table above we can see the mean of wage by marital status, there are males who never married, married, widowed, divorced or separated. ANOVA will help us to answer the question:</li>
</ul>
<div id="exxample" class="illustration" style="color: Sienna">
<p>Are the mean differences in wage by marital status explainable by chance alone?</p>
</div>
<ul>
<li><p>In this case ANOVA could tell us: Yes! there is a difference, but where?</p></li>
<li><p>In this scenario, ANOVA will allow us to do <em>pairwise comparisons</em> , this means; we could compare the mean of divorced males versus the mean of married males, but also test all the combinations later on. This is called a <em>post hoc</em> analysis.</p></li>
</ul>
</section>
<section id="lets-make-up-time-for-anova-cont." class="slide level2 smaller scrollable" data-chalkboard-buttons="true">
<h2>Let’s make up time for ANOVA (cont.)</h2>
<ul>
<li>The ANOVA follows the logic of variance decomposition:</li>
</ul>
<span class="math display">\[\begin{equation}
outcome_{i} = (model) + error_{i}
\end{equation}\]</span>
<ul>
<li><p>This means, that ANOVA accounts for the variances within your groups, and also calculates the variance that is explained by your MODEL. In fact, the Classical Regression Model does exactly the same thing.</p></li>
<li><p>Remember: The line of best fit in regression is estimated adding the sum of square distances from the line. The line with the lowest sum of distances is the best line in regression.</p></li>
<li><p>We are going to do something similar in ANOVA, it is called the <em>Total Sum of Squares (</em><span class="math inline">\(SS_{T}\)</span>), this calculation will give you the distance from the <strong><em>grand mean</em></strong>:</p></li>
</ul>
<span class="math display">\[\begin{equation}
SS_{T} = \sum^N_{i=1}(x_{i}-\bar{x}_{(grandMean)})
\end{equation}\]</span>
<ul>
<li>The term <span class="math inline">\(x_{i}\)</span> is the score or value for each observation, and <span class="math inline">\(\bar{x}_{(grandMean)}\)</span> is the overall mean.</li>
</ul>
</section>
<section id="lets-make-up-time-for-anova-cont.-1" class="slide level2 smaller scrollable">
<h2>Let’s make up time for ANOVA (cont.)</h2>
<ul>
<li><p>We can continue with our example with <code>wage</code> <span class="math inline">\(\sim\)</span> <code>maritl</code>.</p></li>
<li><p>We can calculate the grand mean of <code>wage</code>:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>WageGrandMean <span class="ot">&lt;-</span> <span class="fu">mean</span>(Wage<span class="sc">$</span>wage)</span>
<span id="cb12-2"><a></a>WageGrandMean </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 111.7036</code></pre>
</div>
</div>
<ul>
<li>Now we could estimate <span class="math inline">\(SS_{t}\)</span> in <code>R</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>sstData <span class="ot">&lt;-</span> Wage <span class="sc">|&gt;</span> <span class="fu">select</span>(wage, maritl) <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a></a>  <span class="fu">mutate</span>(<span class="at">SSt =</span> (wage <span class="sc">-</span> <span class="fu">mean</span>(wage))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb14-3"><a></a>  </span>
<span id="cb14-4"><a></a><span class="fu">sum</span>(sstData<span class="sc">$</span>SSt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5222086</code></pre>
</div>
</div>
<p>The total <span class="math inline">\(SS\)</span> is 5222086. This is the TOTAL variation within the data.</p>
<ul>
<li>We also need to estimate the <strong><em>Model Sum of Squares:</em></strong></li>
</ul>
<span class="math display">\[\begin{equation}

SS_{M} = \sum^k_{n=1}n_{k}(\bar{x}_{k}-\bar{x}_{grandMean})^2
\end{equation}\]</span>
<ul>
<li><p><span class="math inline">\(k\)</span> represents each group, in simple words we are estimating the mean difference of each group from the overall mean. That’s the distance from the grand mean.</p></li>
<li><p>We will need to estimate the residuals of the our model, the residuals is variance not explained by our ANOVA model. The estimation is:</p></li>
</ul>
</section>
<section id="lets-make-up-time-for-anova-cont.-2" class="slide level2 smaller scrollable">
<h2>Let’s make up time for ANOVA (cont.)</h2>

<img data-src="ssr.png" class="r-stretch"><ul>
<li>In this estimation we calculate the difference of each observation from the group mean where the observation is located. So, for instance if Katie was in the divorced group, then we could compute: <span class="math inline">\(wage_{katie} - mean(wage_{divorced})\)</span>. This is an indicator of variation not explained by the model. This means, ANOVA does not explain what happens within each group’s variation, it accounts for the between group variation.</li>
</ul>
</section>
<section id="time-for-examples" class="slide level2 smaller scrollable">
<h2>Time for examples !</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>modelAnova <span class="ot">&lt;-</span> <span class="fu">aov</span>(wage <span class="sc">~</span> maritl, <span class="at">data =</span> Wage)</span>
<span id="cb16-2"><a></a><span class="fu">summary</span>(modelAnova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Df  Sum Sq Mean Sq F value Pr(&gt;F)    
maritl         4  363144   90786   55.96 &lt;2e-16 ***
Residuals   2995 4858941    1622                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>The result showed that the difference is not explained by chance alone. But wait, this is an <em>omnibus</em> test. It just tell me that at least one mean is different.</li>
</ul>
</section>
<section id="time-for-examples-1" class="slide level2 smaller scrollable">
<h2>Time for examples !</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> Wage,<span class="fu">aes</span>(<span class="at">x=</span>maritl, <span class="at">y=</span>wage, <span class="at">fill=</span>maritl)) <span class="sc">+</span></span>
<span id="cb18-2"><a></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb18-3"><a></a>   <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">"mean"</span>, <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb18-4"><a></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">option=</span><span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb18-6"><a></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb18-7"><a></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Marital Status"</span>, <span class="at">y=</span> <span class="st">"Wage"</span>, <span class="at">title =</span> <span class="st">"Boxplot of Wage by Marital Status"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (`geom_segment()`).</code></pre>
</div>

</div>
<img data-src="AssumptionsAndMore_files/figure-html/unnamed-chunk-7-1.png" width="672" class="r-stretch"></section>
<section id="time-for-examples-2" class="slide level2 smaller scrollable">
<h2>Time for examples !</h2>
<ul>
<li>Let’s see the pairwise comparisons:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>pairTest <span class="ot">&lt;-</span><span class="fu">TukeyHSD</span>(modelAnova)</span>
<span id="cb20-2"><a></a></span>
<span id="cb20-3"><a></a></span>
<span id="cb20-4"><a></a></span>
<span id="cb20-5"><a></a></span>
<span id="cb20-6"><a></a><span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(pairTest, <span class="cf">function</span>(x) <span class="fu">round</span>(x,<span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a></a>  <span class="fu">rename</span>(<span class="at">meanDiff =</span> maritl.diff,</span>
<span id="cb20-8"><a></a>          <span class="at">lower =</span> maritl.lwr ,</span>
<span id="cb20-9"><a></a>         <span class="at">upper =</span> maritl.upr ,</span>
<span id="cb20-10"><a></a>         <span class="at">pvalueAdj =</span> maritl.p.adj</span>
<span id="cb20-11"><a></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a></a> <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Pairwise Contrast"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a></a><span class="fu">kable_classic_2</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> T, </span>
<span id="cb20-14"><a></a>                <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 lightable-hover" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Pairwise Contrast</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">meanDiff</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pvalueAdj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2. Married-1. Never Married</td>
<td style="text-align: right;">26.13</td>
<td style="text-align: right;">21.18</td>
<td style="text-align: right;">31.07</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">3. Widowed-1. Never Married</td>
<td style="text-align: right;">6.80</td>
<td style="text-align: right;">-18.78</td>
<td style="text-align: right;">32.39</td>
<td style="text-align: right;">0.95</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4. Divorced-1. Never Married</td>
<td style="text-align: right;">10.42</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">19.25</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">5. Separated-1. Never Married</td>
<td style="text-align: right;">8.48</td>
<td style="text-align: right;">-6.96</td>
<td style="text-align: right;">23.92</td>
<td style="text-align: right;">0.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3. Widowed-2. Married</td>
<td style="text-align: right;">-19.32</td>
<td style="text-align: right;">-44.66</td>
<td style="text-align: right;">6.02</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">4. Divorced-2. Married</td>
<td style="text-align: right;">-15.70</td>
<td style="text-align: right;">-23.77</td>
<td style="text-align: right;">-7.63</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5. Separated-2. Married</td>
<td style="text-align: right;">-17.64</td>
<td style="text-align: right;">-32.66</td>
<td style="text-align: right;">-2.63</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">4. Divorced-3. Widowed</td>
<td style="text-align: right;">3.62</td>
<td style="text-align: right;">-22.75</td>
<td style="text-align: right;">29.99</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5. Separated-3. Widowed</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">-27.58</td>
<td style="text-align: right;">30.93</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">5. Separated-4. Divorced</td>
<td style="text-align: right;">-1.94</td>
<td style="text-align: right;">-18.65</td>
<td style="text-align: right;">14.76</td>
<td style="text-align: right;">1.00</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="f-ratio-estimation" class="slide level2 smaller scrollable">
<h2><em>F</em> ratio estimation</h2>
<ul>
<li>In previous classes we studied the <span class="math inline">\(t\)</span>-test. Hopefully, you remember the <span class="math inline">\(t\)</span>-distribution:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb21-2"><a></a></span>
<span id="cb21-3"><a></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rt</span>(<span class="dv">30000</span>,<span class="dv">5</span>)),</span>
<span id="cb21-4"><a></a>     <span class="at">xlab =</span> <span class="st">"Simulated Values"</span>,</span>
<span id="cb21-5"><a></a>     <span class="at">ylab =</span> <span class="st">"p(y)/likelihood"</span>,</span>
<span id="cb21-6"><a></a>     <span class="at">main =</span> <span class="st">"Probability density plot generated from the t-distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="AssumptionsAndMore_files/figure-html/unnamed-chunk-9-1.png" width="672" class="r-stretch"></section>
<section id="f-ratio-estimation-1" class="slide level2 smaller scrollable">
<h2><em>F</em> ratio estimation</h2>
<ul>
<li><p>The t-distribution is used to find the probability of the estimated mean difference.</p></li>
<li><p>In ANOVA we will use the F-distribution to find the probability of the estimated difference. In <span class="math inline">\(t\)</span>-test we find only one mean difference, in ANOVA we will have several mean differences. The F-distribution will help us to test all the mean differences at the same time. That’s way we call <strong><em>omnibus test</em></strong> the first step in ANOVA.</p></li>
<li><p>This distribution is a little bit peculiar. Because it requires degrees of <strong><em>freedom in the numerator</em></strong> and <strong><em>the denominator</em></strong>, we will see later how are we going to use these degrees of freedom in the context of the ANOVA.</p></li>
</ul>
</section>
<section id="f-ratio-estimation-2" class="slide level2 smaller scrollable">
<h2><em>F</em> ratio estimation</h2>
<p><strong><em>Just another F distribution</em></strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb22-2"><a></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rf</span>(<span class="dv">30000</span>,<span class="dv">5</span>,<span class="dv">10</span>)),</span>
<span id="cb22-3"><a></a>     <span class="at">xlab =</span> <span class="st">"Simulated Values"</span>,</span>
<span id="cb22-4"><a></a>     <span class="at">ylab =</span> <span class="st">"Likelihood"</span>,</span>
<span id="cb22-5"><a></a>     <span class="at">main =</span> <span class="st">"Probability density plot generated from the F-distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="AssumptionsAndMore_files/figure-html/unnamed-chunk-10-1.png" width="672" class="r-stretch"></section>
<section id="f-ratio-estimation-lets-go-to-the-point" class="slide level2 smaller scrollable" data-background-image="slide2.png" data-background-opacity="0.5">
<h2><em>F</em> ratio estimation: let’s go to the point</h2>
<ul>
<li><p>To estimate the <em>F</em> ratio we need first to estimate the <strong><em>Mean Squares</em></strong> based on the Sum of Squares.</p></li>
<li><p>We previously saw the formula to estimate the <span class="math inline">\(SS_{R}\)</span>, which in simple words, the total variation due to external factors not controlled by the variables in the model. While <span class="math inline">\(SS_{M}\)</span> is the total variation accounted by the ANOVA model. <span class="math display">\[\begin{align}
MS_{M} &amp;= \frac{SS_{M}}{df_{M}}\\
MS_{R} &amp;= \frac{SS_{R}}{df_{R}}\\
\end{align}\]</span></p></li>
</ul>
<p><span class="math inline">\(MS_{m}\)</span> is the average amount of variation explained by the model (e.g., the systematic variation) , whereas <span class="math inline">\(MS_{R}\)</span> is a gauge of the average amount of variation explained by extraneous variables (the unsystematic variation) <span class="citation" data-cites="field2012discovering">(<a href="#/references" role="doc-biblioref" onclick="">Field et al., 2012</a>)</span>.</p>
<ul>
<li><p>The <span class="math inline">\(df\)</span> in <span class="math inline">\(MS_{M}\)</span> are estimated by subtracting 1 to the number of groups. In our example we have 5 groups, then we should do <span class="math inline">\(df = 5-1\)</span>. The degrees of freedom in <span class="math inline">\(MS_{R}\)</span> are estimated by computing <span class="math inline">\(N-k\)</span>, where <span class="math inline">\(N\)</span> is the sample size and <span class="math inline">\(k\)</span> the number of groups. In our example would be <span class="math inline">\(df = 3000-5\)</span>.</p></li>
<li><p>Let’s take a loot again at the ANOVA taht we estimated before:</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a>modelAnova <span class="ot">&lt;-</span> <span class="fu">aov</span>(wage <span class="sc">~</span> maritl, <span class="at">data =</span> Wage)</span>
<span id="cb23-2"><a></a><span class="fu">summary</span>(modelAnova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Df  Sum Sq Mean Sq F value Pr(&gt;F)    
maritl         4  363144   90786   55.96 &lt;2e-16 ***
Residuals   2995 4858941    1622                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>Remember that we had 5 marital status groups, and the total sample is 3000 males. If you check the <code>Df</code> column in the table above you will see two numbers, the first one is 4 (<span class="math inline">\(5-1=4\)</span>) , and the second number is 2995 (<span class="math inline">\(3000-5= 2995\)</span>).</li>
</ul>
</section>
<section id="f-ratio-estimation-lets-go-to-the-point-1" class="slide level2 smaller scrollable">
<h2><em>F</em> ratio estimation: let’s go to the point</h2>
<ul>
<li>After computing the Mean Squares and degrees of freedom, you’ll be able estimate the <em>F</em> ratio:</li>
</ul>
<span class="math display">\[\begin{align}
F &amp;= \frac{MS_{M}}{MS_{R}}\\
  &amp;= \frac{90786}{1622}\\
  &amp;= 55.96\\
\end{align}\]</span>
<ul>
<li>The <em>F</em> in this case is a ratio of the variation explained by the model. If we conducted an experiment, we want a large <em>F</em> ratio because it would mean that we maximize the systematic variance explained by the experiment. Ideally, <span class="math inline">\(MS_{R}\)</span> should be small.</li>
</ul>
</section>
<section id="f-ratio-estimation-lets-go-to-the-point-2" class="slide level2 smaller scrollable">
<h2><em>F</em> ratio estimation: let’s go to the point</h2>
<ul>
<li>The Cumulative Density Function of the <em>F</em> distribution will help us to estimate the probability of seeing a number as extreme as: 55.96. The red line corresponds to the location of 55.96.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a>simValues <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">60</span>,<span class="fl">0.1</span>)</span>
<span id="cb25-2"><a></a></span>
<span id="cb25-3"><a></a>values <span class="ot">&lt;-</span>  <span class="fu">pf</span>(simValues, </span>
<span id="cb25-4"><a></a>              <span class="at">df1 =</span> <span class="dv">4</span>, </span>
<span id="cb25-5"><a></a>              <span class="at">df2 =</span> <span class="dv">2995</span>,</span>
<span id="cb25-6"><a></a>              <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-7"><a></a></span>
<span id="cb25-8"><a></a><span class="fu">plot</span>(simValues, values, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb25-9"><a></a>     <span class="at">xlab =</span> <span class="st">"F values"</span>,</span>
<span id="cb25-10"><a></a>     <span class="at">ylab =</span> <span class="st">"Probability of F"</span>,</span>
<span id="cb25-11"><a></a>     <span class="at">main =</span> <span class="st">"Probability of observing F values"</span>)</span>
<span id="cb25-12"><a></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">55.96</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="AssumptionsAndMore_files/figure-html/unnamed-chunk-12-1.png" width="672" class="r-stretch"></section>
<section>
<section id="assumptions" class="title-slide slide level1 smaller scrollable center">
<h1>Assumptions</h1>

</section>
<section id="anova-and-classical-regression-model" class="slide level2 smaller scrollable">
<h2>ANOVA and Classical Regression Model</h2>
<ul>
<li><p>One of the most important assumptions in ANOVA and Classical Regression Model is constant variance.</p></li>
<li><p>When you estimate an ANOVA you could test this assumption using the Levene’s Test, the same test that we used to test the constant variance in <span class="math inline">\(t\)</span>-test.</p></li>
<li><p>The null hypothesis in the Levene’s test states: <strong><em>The variances of all groups are equal</em></strong>. If the test shows a <span class="math inline">\(p\)</span>-value lower than 0.05, we reject the null hypothesis.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a><span class="fu">leveneTest</span>(wage <span class="sc">~</span> maritl, <span class="at">data =</span> Wage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
        Df F value    Pr(&gt;F)    
group    4  10.258 3.006e-08 ***
      2995                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>The result shows a <span class="math inline">\(p\)</span>-value lower than 0.05, therefore we should reject the null hypothesis. The variances are not equal between groups.</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Always remember!</strong></p>
</div>
<div class="callout-content">
<p>ALL OF THE ASSUMPTIONS REFER TO THE DATA-GENERATING PROCESS. NONE OF THE ASSUMPTIONS REFER TO THE ACTUAL OBSERVED DATA <span class="citation" data-cites="westfall2020understanding">(<a href="#/references" role="doc-biblioref" onclick="">Westfall &amp; Arias, 2020</a>)</span></p>
</div>
</div>
</div>
<ul>
<li>In this case, we have a large sample size, this might cause a small p-value in the case of the Levene’s Test.</li>
</ul>
</section>
<section id="anova-and-classical-regression-model-1" class="slide level2 smaller scrollable">
<h2>ANOVA and Classical Regression Model</h2>
<ul>
<li>In the context of regression we can plot the predicted values called <span class="math inline">\(\hat{y}\)</span> (“yhat”), versus the residuals</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a>newWage <span class="ot">&lt;-</span> Wage <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">married =</span> <span class="fu">ifelse</span>(maritl <span class="sc">==</span> <span class="st">"2. Married"</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb32-2"><a></a>                          <span class="at">widowed =</span> <span class="fu">ifelse</span>(maritl<span class="sc">==</span> <span class="st">"3. Widowed"</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb32-3"><a></a>                          <span class="at">divorced =</span> <span class="fu">ifelse</span>(maritl<span class="sc">==</span> <span class="st">"4. Divorced"</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb32-4"><a></a>                          <span class="at">separate =</span> <span class="fu">ifelse</span>(maritl<span class="sc">==</span> <span class="st">"5. Separated"</span>, <span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb32-5"><a></a></span>
<span id="cb32-6"><a></a></span>
<span id="cb32-7"><a></a></span>
<span id="cb32-8"><a></a>fitModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage <span class="sc">~</span> married  <span class="sc">+</span> widowed <span class="sc">+</span> divorced <span class="sc">+</span> separate, <span class="at">data =</span> newWage)</span>
<span id="cb32-9"><a></a></span>
<span id="cb32-10"><a></a>y.hat <span class="ot">=</span> fitModel<span class="sc">$</span>fitted.values</span>
<span id="cb32-11"><a></a>resid <span class="ot">=</span> fitModel<span class="sc">$</span>residuals</span>
<span id="cb32-12"><a></a><span class="fu">plot</span>(y.hat, resid,</span>
<span id="cb32-13"><a></a>     <span class="at">xlab =</span> <span class="st">"Predicted wage"</span>,</span>
<span id="cb32-14"><a></a>     <span class="at">ylab =</span> <span class="st">"residuals"</span>)</span>
<span id="cb32-15"><a></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="AssumptionsAndMore_files/figure-html/unnamed-chunk-14-1.png" width="672" class="r-stretch"></section>
<section id="anova-and-classical-regression-model-2" class="slide level2 smaller scrollable">
<h2>ANOVA and Classical Regression Model</h2>
<ul>
<li><p>In the previous plot we can see more variability when the predicted wage is high. We can also see differences in variability in the lower income groups.</p></li>
<li><p>We can plot similar information, but this time let’s use the absolute residuals:</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a>abs.resid <span class="ot">=</span> <span class="fu">abs</span>(resid)</span>
<span id="cb33-2"><a></a><span class="fu">plot</span>(y.hat, abs.resid,</span>
<span id="cb33-3"><a></a>     <span class="at">xlab =</span> <span class="st">"Predicted wage"</span>,</span>
<span id="cb33-4"><a></a>     <span class="at">ylab =</span> <span class="st">"Absolute residuals"</span>,</span>
<span id="cb33-5"><a></a>     <span class="at">main =</span> <span class="st">"Predicted wage by absolute residuals"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="AssumptionsAndMore_files/figure-html/unnamed-chunk-15-1.png" width="672" class="r-stretch"><ul>
<li><p>Similar pattern, there is more variability in the groups where men earn more money. But is this bad for the linear model?</p></li>
<li><p>It depends. We need to think if this is just part of the data generating process.</p></li>
</ul>
</section>
<section id="anova-and-classical-regression-model-3" class="slide level2 smaller scrollable">
<h2>ANOVA and Classical Regression Model</h2>
<ul>
<li>We can check the constant variance assumption in the context of a continuous predictor. This example only applies to Linear Regression, it won’t work with ANOVA because ANOVA only supports nominal predictors (groups).</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a>rum <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"ruminationClean.csv"</span>)</span>
<span id="cb34-2"><a></a></span>
<span id="cb34-3"><a></a>fitModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(anx <span class="sc">~</span> worry, <span class="at">data =</span> rum)</span>
<span id="cb34-4"><a></a></span>
<span id="cb34-5"><a></a>y.hat <span class="ot">=</span> fitModel<span class="sc">$</span>fitted.values</span>
<span id="cb34-6"><a></a>resid <span class="ot">=</span> fitModel<span class="sc">$</span>residuals</span>
<span id="cb34-7"><a></a><span class="fu">plot</span>(y.hat, resid,</span>
<span id="cb34-8"><a></a>     <span class="at">xlab =</span> <span class="st">"Predicted Anxiety"</span>,</span>
<span id="cb34-9"><a></a>     <span class="at">ylab =</span> <span class="st">"residuals"</span>)</span>
<span id="cb34-10"><a></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="AssumptionsAndMore_files/figure-html/unnamed-chunk-16-1.png" width="672" class="r-stretch"></section>
<section id="anova-and-classical-regression-model-4" class="slide level2 smaller scrollable">
<h2>ANOVA and Classical Regression Model</h2>
<ul>
<li><p>Given that plots are sometimes difficult to interpret in this case, you might conduct another test called the Glejser test <span class="citation" data-cites="westfall2020understanding">(<a href="#/references" role="doc-biblioref" onclick="">Westfall &amp; Arias, 2020</a>)</span>.</p></li>
<li><p>In this test we regress the absolute residuals on the predicted values. So, we are going to estimate a regression model to predict the residual, weird right?</p></li>
<li><p>The short story is that we will get an slope, and if this slope is not explained by chance alone we will reject the constant variance assumption.</p></li>
<li><p>Let’s test the constant variance assumption when we estimate anxiety <span class="math inline">\(\sim\)</span> worry.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a><span class="do">### The target model</span></span>
<span id="cb35-2"><a></a>fitAnx <span class="ot">&lt;-</span> <span class="fu">lm</span>(anx <span class="sc">~</span> worry, <span class="at">data =</span> rum)</span>
<span id="cb35-3"><a></a><span class="do">### get the residuals and predicted values</span></span>
<span id="cb35-4"><a></a>yhat <span class="ot">&lt;-</span>  fitAnx<span class="sc">$</span>fitted.values <span class="do">## predicted values</span></span>
<span id="cb35-5"><a></a>resi <span class="ot">&lt;-</span> <span class="fu">abs</span>(fitAnx<span class="sc">$</span>residuals) <span class="do">## residuals </span></span>
<span id="cb35-6"><a></a></span>
<span id="cb35-7"><a></a><span class="fu">summary</span>(<span class="fu">lm</span>(resi <span class="sc">~</span> yhat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = resi ~ yhat)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4731 -1.1677 -0.3061  0.8137  7.6189 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.71106    0.35353   2.011   0.0457 *  
yhat         0.35385    0.08094   4.372 2.01e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.777 on 194 degrees of freedom
Multiple R-squared:  0.08968,   Adjusted R-squared:  0.08499 
F-statistic: 19.11 on 1 and 194 DF,  p-value: 2.009e-05</code></pre>
</div>
</div>
<ul>
<li>In this case we cannot hold the assumption of homocedasticity (constant variance), because the estimated slope is not explained by chance alone (<span class="math inline">\(p &lt; .001\)</span>).</li>
</ul>
</section>
<section id="classical-regression-model-normality-assumption" class="slide level2 smaller scrollable">
<h2>Classical Regression Model: normality assumption</h2>
<ul>
<li>You can graphically evaluate if your model holds the assumption of normality. Remember that this assumption states that each conditional distribution <span class="math inline">\(p(y|x)\)</span> is normally distributed.</li>
<li>The best option is to plot the residuals of your model versus the quantiles of the normal distribution, this is called a <code>QQ-Plot</code> (quantile to quantile plot).</li>
</ul>
</section>
<section id="classical-regression-model-normality-assumption-1" class="slide level2 smaller scrollable">
<h2>Classical Regression Model: normality assumption</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a><span class="do">### The target model</span></span>
<span id="cb37-2"><a></a>fitAnx <span class="ot">&lt;-</span> <span class="fu">lm</span>(anx <span class="sc">~</span> worry, <span class="at">data =</span> rum)</span>
<span id="cb37-3"><a></a><span class="do">### get the residuals and predicted values</span></span>
<span id="cb37-4"><a></a>res <span class="ot">&lt;-</span> <span class="fu">abs</span>(fitAnx<span class="sc">$</span>residuals) <span class="do">## residuals </span></span>
<span id="cb37-5"><a></a><span class="fu">qqnorm</span>(res)</span>
<span id="cb37-6"><a></a><span class="fu">qqline</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="AssumptionsAndMore_files/figure-html/unnamed-chunk-18-1.png" width="672" class="r-stretch"></section>
<section id="classical-regression-model-normality-assumption-2" class="slide level2 smaller scrollable">
<h2>Classical Regression Model: normality assumption</h2>
<ul>
<li>The qqplot can be sometimes difficult to read. We could perform a test called the Shapiro-Wilk test. In this test, the null hypothesis states “There is not deviation from the normal distribution”. A <span class="math inline">\(p\)</span>-value less than .05 means that the model does not hold the assumption of conditional normality.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a><span class="fu">shapiro.test</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  res
W = 0.85861, p-value = 1.612e-12</code></pre>
</div>
</div>
<ul>
<li>The Shapiro-Wilk test showed a p-value lower than .001, this means that the deviations of the residuals from the normal distribution are not explained by chance.</li>
</ul>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>IMPORTANT!</strong></p>
</div>
<div class="callout-content">
<p>The regression model and the General Linear Model does not assume that the outcome should come from a normally distributed process. That’s why the normality test is performed on the residuals of the model. The residuals are the product of the conditional relationship <span class="math inline">\(p(y|x)\)</span>. Don’t test the normality assumption on your dependent or outcome variable.</p>
</div>
</div>
</div>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>

<div class="quarto-auto-generated-content">
<p><img src="stan-state-logo_nickname-full-color.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://blackhill86.github.io/mm2/"><strong>Visit my website</strong></a></p>
</div>
</div>
<div class="reveal-header">
<div class="header-logo">
<img data-src="warrior_head2.png">
</div>
<div class="sc-title">
<p> </p>
</div>
<div class="header-text">
<p> </p>
</div>
<div class="sb-title">
<p> </p>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-field2012discovering" class="csl-entry" role="listitem">
Field, A., Miles, J., &amp; Field, Z. (2012). <em>Discovering statistics using r</em>. Sage publications.
</div>
<div id="ref-westfall2020understanding" class="csl-entry" role="listitem">
Westfall, P. H., &amp; Arias, A. L. (2020). <em>Understanding regression analysis: A conditional distribution approach</em>. Chapman; Hall/CRC.
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"theme":"whiteboard"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>